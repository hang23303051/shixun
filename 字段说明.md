# ğŸ“‹ Userè¡¨å­—æ®µè¯´æ˜

## æ ¸å¿ƒå­—æ®µ
| å­—æ®µ | ç±»å‹ | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|------|--------|
| email | EmailField (PK) | é‚®ç®±ï¼ˆä¸»é”®ï¼‰ | - |
| username | CharField | ç”¨æˆ·å | - |
| password | CharField | åŠ å¯†å¯†ç  | - |
| avatar | ImageField | å¤´åƒ | NULL |
| is_active | BooleanField | æ¿€æ´»çŠ¶æ€ | False |
| created_at | DateTimeField | åˆ›å»ºæ—¶é—´ | è‡ªåŠ¨ |
| updated_at | DateTimeField | æ›´æ–°æ—¶é—´ | è‡ªåŠ¨ |

## ä¸´æ—¶å­—æ®µï¼ˆæ¿€æ´»ç›¸å…³ï¼‰
| å­—æ®µ | ç±»å‹ | è¯´æ˜ | ä½•æ—¶æ¸…ç©º |
|------|------|------|----------|
| activation_token | CharField(64) | æ¿€æ´»ä»¤ç‰Œ | æ¿€æ´»æˆåŠŸå âœ… |
| activation_token_created | DateTimeField | ä»¤ç‰Œåˆ›å»ºæ—¶é—´ | æ¿€æ´»æˆåŠŸå âœ… |
| reset_password_token | CharField(6) | å¯†ç é‡ç½®éªŒè¯ç  | é‡ç½®æˆåŠŸå âœ… |
| reset_password_token_created | DateTimeField | éªŒè¯ç åˆ›å»ºæ—¶é—´ | é‡ç½®æˆåŠŸå âœ… |

---

## â“ ä¸ºä»€ä¹ˆè¿™4ä¸ªå­—æ®µç»å¸¸æ˜¯ç©ºçš„ï¼Ÿ

### è¿™æ˜¯**æ­£å¸¸çš„**ï¼è¿™äº›å­—æ®µçš„ç”Ÿå‘½å‘¨æœŸï¼š

### ğŸ“§ æ¿€æ´»æµç¨‹
```
1. ç”¨æˆ·æ³¨å†Œ
   â†“
2. ç”Ÿæˆ activation_token + activation_token_created
   â†“
3. å‘é€æ¿€æ´»é‚®ä»¶
   â†“
4. ç”¨æˆ·ç‚¹å‡»æ¿€æ´»é“¾æ¥
   â†“
5. éªŒè¯æˆåŠŸåï¼š
   - is_active = True âœ…
   - activation_token = NULL âŒ (æ¸…ç©º)
   - activation_token_created = NULL âŒ (æ¸…ç©º)
```

### ğŸ”‘ å¯†ç é‡ç½®æµç¨‹
```
1. ç”¨æˆ·å¿˜è®°å¯†ç 
   â†“
2. ç”Ÿæˆ reset_password_token + reset_password_token_created
   â†“
3. å‘é€éªŒè¯ç é‚®ä»¶
   â†“
4. ç”¨æˆ·è¾“å…¥éªŒè¯ç å¹¶é‡ç½®å¯†ç 
   â†“
5. é‡ç½®æˆåŠŸåï¼š
   - password = æ–°å¯†ç  âœ…
   - reset_password_token = NULL âŒ (æ¸…ç©º)
   - reset_password_token_created = NULL âŒ (æ¸…ç©º)
```

---

## âœ… æ­£å¸¸çŠ¶æ€

### å·²æ¿€æ´»çš„è€ç”¨æˆ·
```sql
email: user@example.com
is_active: 1
activation_token: NULL          â† æ­£å¸¸ï¼å·²æ¿€æ´»æ‰€ä»¥æ¸…ç©º
activation_token_created: NULL  â† æ­£å¸¸ï¼å·²æ¿€æ´»æ‰€ä»¥æ¸…ç©º
reset_password_token: NULL      â† æ­£å¸¸ï¼æ²¡åœ¨é‡ç½®å¯†ç 
reset_password_token_created: NULL
```

### åˆšæ³¨å†Œæœªæ¿€æ´»çš„æ–°ç”¨æˆ·
```sql
email: newuser@example.com
is_active: 0
activation_token: "abc123xyz..."        â† æœ‰å€¼ï¼ç­‰å¾…æ¿€æ´»
activation_token_created: 2025-12-03...  â† æœ‰å€¼ï¼
reset_password_token: NULL
reset_password_token_created: NULL
```

### æ­£åœ¨é‡ç½®å¯†ç çš„ç”¨æˆ·
```sql
email: user@example.com
is_active: 1
activation_token: NULL
activation_token_created: NULL
reset_password_token: "123456"          â† æœ‰å€¼ï¼æ­£åœ¨é‡ç½®
reset_password_token_created: 2025-12-03... â† æœ‰å€¼ï¼
```

---

## ğŸ—‘ï¸ å·²åˆ é™¤çš„å­—æ®µ

### âŒ is_staffï¼ˆå·²åˆ é™¤ï¼‰
**åŸå› ï¼š** 
- æ™®é€šç”¨æˆ·æ³¨å†Œä¸éœ€è¦è¿™ä¸ªå­—æ®µ
- åªæœ‰Django Adminéœ€è¦
- æ‰€æœ‰ç”¨æˆ·éƒ½æ˜¯æ™®é€šç”¨æˆ·

### âŒ is_superuserï¼ˆå·²åˆ é™¤ï¼‰
**åŸå› ï¼š**
- æ™®é€šç”¨æˆ·æ³¨å†Œä¸éœ€è¦è¿™ä¸ªå­—æ®µ
- åªæœ‰Django Adminéœ€è¦
- æ‰€æœ‰ç”¨æˆ·éƒ½æ˜¯æ™®é€šç”¨æˆ·

---

## ğŸ“Š æ•°æ®åº“ç»Ÿè®¡ç¤ºä¾‹

å‡è®¾æœ‰100ä¸ªç”¨æˆ·ï¼š
- 90ä¸ªå·²æ¿€æ´»è€ç”¨æˆ· â†’ 4ä¸ªä¸´æ—¶å­—æ®µéƒ½æ˜¯NULL âœ…
- 8ä¸ªæ–°æ³¨å†Œæœªæ¿€æ´» â†’ activationç›¸å…³å­—æ®µæœ‰å€¼ âœ…
- 2ä¸ªæ­£åœ¨é‡ç½®å¯†ç  â†’ resetç›¸å…³å­—æ®µæœ‰å€¼ âœ…

**æ‰€ä»¥å¤§éƒ¨åˆ†æ—¶å€™è¿™4ä¸ªå­—æ®µéƒ½æ˜¯ç©ºçš„ï¼Œè¿™æ˜¯æ­£å¸¸çš„ï¼** ğŸ‰

---

## ğŸ” å¦‚ä½•æ£€æŸ¥

### æŸ¥è¯¢æœªæ¿€æ´»ç”¨æˆ·
```sql
SELECT email, username, is_active, activation_token 
FROM user 
WHERE is_active = 0;
```

### æŸ¥è¯¢æ­£åœ¨é‡ç½®å¯†ç çš„ç”¨æˆ·
```sql
SELECT email, username, reset_password_token, reset_password_token_created
FROM user 
WHERE reset_password_token IS NOT NULL;
```

### æŸ¥è¯¢æ‰€æœ‰å·²æ¿€æ´»ç”¨æˆ·
```sql
SELECT email, username, is_active 
FROM user 
WHERE is_active = 1;
```

---

**æœ€åæ›´æ–°ï¼š** 2025-12-03  
**ä¼˜åŒ–ï¼š** åˆ é™¤äº†ä¸å¿…è¦çš„is_staffå’Œis_superuserå­—æ®µ
